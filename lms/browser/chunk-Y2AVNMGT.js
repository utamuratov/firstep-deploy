import{a as u}from"./chunk-OBQI4AT4.js";import{a as g}from"./chunk-AAYNF2LC.js";import{U as h,W as f}from"./chunk-ZKNP4OTC.js";import{H as l,T as m,bb as c,ca as i,eb as d,f as n,hb as p,ya as t}from"./chunk-63MFA3PC.js";import{a,b as o}from"./chunk-RJNTS35V.js";var v=class s{constructor(e){this.service=e}confirmationService=i(h);msgService=i(f);data=t([]);first=0;rows=10;totalItems;tableData=u({sort:[{key:"id",value:0}]});editEntityId=t(null);openDrawer=d(!1);loading=t(!1);destroy$=new n;ngOnInit(){this.loadPage()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onPageChange(e){this.first=e.first??0,this.rows=e.rows??10,this.loadPage()}clickEditEntity(e){this.editEntityId.set(e.id),this.openDrawer.set(!0)}removeConfirm(e){this.confirmationService.confirm({message:"Siz aniq shu elementni ochirishga tayyormisiz?",header:"O`chirish",icon:"pi pi-info-circle",rejectLabel:"Cancel",rejectButtonProps:{label:"Bekor qilish",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Tasdiqlash",severity:"danger"},accept:()=>{this.openDrawer.set(!1),this.removeEntity(e)},reject:()=>{this.openDrawer.set(!1)}})}loadPage(){this.loading.set(!0),this.service.query(o(a({},this.tableData),{pageIndex:this.first/10})).pipe(m(this.destroy$),l(()=>this.loading.set(!1))).subscribe(e=>this.setData(e))}open(){this.editEntityId.set(null),this.openDrawer.set(!0)}setData(e){this.data.set(e.result.items),this.totalItems=e.result.total}onSubmit(){this.openDrawer.set(!1),this.loadPage()}onFilterChange(e){this.tableData.filter=e,this.loadPage()}removeEntity(e){this.loading.set(!0),this.service.delete(e).subscribe({next:()=>{this.msgService.add({severity:"info",summary:"Muvaffaqiyatli",detail:"Element o`chirildi!"}),this.loadPage()},error:()=>{this.msgService.add({severity:"error",summary:"Xatolik",detail:"Tizimda ayrim muammolar bor!"}),this.loading.set(!1)}})}static \u0275fac=function(r){return new(r||s)(c(g))};static \u0275cmp=p({type:s,selectors:[["ng-component"]],inputs:{openDrawer:[1,"openDrawer"]},outputs:{openDrawer:"openDrawerChange"},decls:0,vars:0,template:function(r,y){},encapsulation:2})};export{v as a};
