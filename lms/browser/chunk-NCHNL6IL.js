import{a as S}from"./chunk-FPHRET7Q.js";import{a as I}from"./chunk-ZMEJBOB4.js";import"./chunk-NYRIM3NQ.js";import{a as oe,b as re}from"./chunk-2WU6MFP7.js";import"./chunk-OBQI4AT4.js";import"./chunk-AAYNF2LC.js";import"./chunk-WMQMVF6V.js";import{a as Z}from"./chunk-R72LOZJZ.js";import{e as ee,h as te}from"./chunk-OLD4CQRK.js";import{b as z,c as _,f as A,g as $,h as H,i as s,k as W,l as J,n as K,q as Q,v as X,z as Y}from"./chunk-GWOLZENT.js";import{a as ne,b as ie}from"./chunk-UM7JX4F5.js";import"./chunk-ZKNP4OTC.js";import{A as G,Eb as o,Fb as t,Gb as m,Kb as U,Nb as C,S as O,U as P,Vb as y,Wb as l,Y as j,Ya as b,Zc as L,ca as g,cc as q,hb as N,ja as u,ka as f,kb as D,lc as w,m as E,mc as F,nb as x,q as R,r as T,ub as c,ya as v,zb as k}from"./chunk-63MFA3PC.js";import{a as B,b as V}from"./chunk-RJNTS35V.js";var h=class n{http=g(L);resourceUrl=ie("api/admin/media");upload(e){let i=new FormData;return i.append("file",e),this.http.post(this.resourceUrl,i)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var M=class n{transform(e){return Object.entries(e).map(([r,a])=>`${a.startsWith("blob:")?a:`${ne.backendUrl}/${a}`} ${r.slice(1)}w`).join(", ")}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=D({name:"srcSet",type:n,pure:!0})};function me(n,e){n&1&&(m(0,"img",24),w(1,"srcSet")),n&2&&c("srcset",F(1,1,e))}function pe(n,e){n&1&&(m(0,"i",30),o(1,"span",31),l(2,"Rasmni tanlash"),t())}function se(n,e){n&1&&(m(0,"img",24),w(1,"srcSet")),n&2&&c("srcset",F(1,1,e))}function ce(n,e){n&1&&(m(0,"i",30),o(1,"span",31),l(2,"Rasmni tanlash"),t())}var le=class n{router=g(te);bannerService=g(S);mediaService=g(h);activatedRoute=g(ee);formGroup=new H({id:new s(null),name:new s(null,[_.required]),link:new s(null,[_.required]),order:new s(null,[_.required]),type:new s(null,[_.required]),active:new s(!1),mobileMediaId:new s(null),desktopMediaId:new s(null)});desktopImage=v(null);mobileImage=v(null);desktopImageFile;mobileImageFile;ngOnInit(){this.activatedRoute.params.pipe(G(e=>e.id),O(e=>this.bannerService.detail(e.id))).subscribe(({result:e})=>{this.mobileImage.set(e.mobileMedia.resolutions),this.desktopImage.set(e.desktopMedia.resolutions),this.formGroup.patchValue(V(B({},e),{desktopMediaId:e.desktopMedia.id,mobileMediaId:e.mobileMedia.id}))})}isEnabled=()=>this.formGroup.value.id?this.formGroup.valid:this.formGroup.valid&&!!this.desktopImageFile&&!!this.mobileImageFile;onImageChange(e,i){let r=e.target.files[0];i==="mobile"?(this.mobileImageFile=r,this.mobileImage.update(()=>I(URL.createObjectURL(r)))):(this.desktopImageFile=r,this.desktopImage.update(()=>I(URL.createObjectURL(r))))}cancel(){this.router.navigate(["/dashboard/settings/banners"])}save(){this.rowValue().pipe(O(e=>e.id?this.bannerService.update(e):this.bannerService.create(e))).subscribe(()=>{this.cancel()})}rowValue(){if(this.mobileImageFile||this.desktopImageFile){let e=[];return this.mobileImageFile&&e.push(this.mediaService.upload(this.mobileImageFile).pipe(P(i=>this.formGroup.get("mobileMediaId").setValue(i.result)))),this.desktopImageFile&&e.push(this.mediaService.upload(this.desktopImageFile).pipe(P(i=>this.formGroup.get("desktopMediaId").setValue(i.result)))),T(e).pipe(R(()=>this.formGroup.getRawValue()))}else return E(this.formGroup.getRawValue())}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=N({type:n,selectors:[["ng-component"]],features:[q([S])],decls:45,vars:7,consts:[["mobileFile",""],["desktopFile",""],[1,"banner-form",3,"formGroup"],[1,"header"],[1,"form-title"],[1,"controls"],[1,"control"],["for","name"],["id","name","placeholder","...","type","text","pInputText","","formControlName","name"],["for","type"],["id","type","placeholder","...","type","text","pInputText","","formControlName","type"],["for","order"],["id","order","placeholder","...","type","number","pInputText","","formControlName","order"],[1,"control","link"],["for","link"],["id","link","placeholder","...","type","text","pInputText","","formControlName","link"],[1,"checkbox"],["formControlName","active","inputId","active",3,"binary"],["for","active"],[1,"images"],[1,"image-container"],["for","mobile"],[1,"image","upload",3,"click"],["type","file","id","mobile","accept","image/*",3,"change","hidden"],[3,"srcset"],["for","desktop"],["type","file","id","desktop","accept","image/*",3,"change","hidden"],[1,"actions"],["label","Bekor qilish","variant","outlined","severity","secondary",3,"onClick"],["label","Saqlash",3,"onClick","disabled"],[1,"pi","pi-plus"],[1,"text"]],template:function(i,r){if(i&1){let a=U();o(0,"form",2)(1,"div",3)(2,"h1",4),l(3,"Banner formasi"),t(),o(4,"div",5)(5,"div",6)(6,"label",7),l(7,"Nomi"),t(),m(8,"input",8),t(),o(9,"div",6)(10,"label",9),l(11,"Turi"),t(),m(12,"input",10),t(),o(13,"div",6)(14,"label",11),l(15,"Tartib"),t(),m(16,"input",12),t(),o(17,"div",13)(18,"label",14),l(19,"Havola"),t(),m(20,"textarea",15),t(),o(21,"div",16),m(22,"p-checkbox",17),o(23,"label",18),l(24,"Aktiv"),t()()()(),o(25,"div",19)(26,"div",20)(27,"label",21),l(28,"Vertikal banner"),t(),o(29,"div",22),C("click",function(){u(a);let d=y(31);return f(d.click())}),o(30,"input",23,0),C("change",function(d){return u(a),f(r.onImageChange(d,"mobile"))}),t(),x(32,me,2,3,"img",24)(33,pe,3,0),t()(),o(34,"div",20)(35,"label",25),l(36,"Gorizontal banner"),t(),o(37,"div",22),C("click",function(){u(a);let d=y(39);return f(d.click())}),o(38,"input",26,1),C("change",function(d){return u(a),f(r.onImageChange(d,"desktop"))}),t(),x(40,se,2,3,"img",24)(41,ce,3,0),t()()(),o(42,"div",27)(43,"p-button",28),C("onClick",function(){return u(a),f(r.cancel())}),t(),o(44,"p-button",29),C("onClick",function(){return u(a),f(r.save())}),t()()()}if(i&2){let a,p;c("formGroup",r.formGroup),b(22),c("binary",!0),b(8),c("hidden",!0),b(2),k((a=r.mobileImage())?32:33,a),b(6),c("hidden",!0),b(2),k((p=r.desktopImage())?40:41,p),b(4),c("disabled",!r.isEnabled())}},dependencies:[X,W,z,J,A,$,K,Q,Z,Y,M,re,oe],styles:[".banner-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.banner-form[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%], .banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%], .banner-form[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%], .banner-form[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-radius:16px;border:1px solid var(--Gray-200, #DCDCDC);background:var(--system-white, #FFF);padding:11px 24px}.banner-form[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{gap:20px;display:flex;flex-direction:column}.banner-form[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap}.banner-form[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]{width:calc(33.3333333333% - 12px)}.banner-form[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{width:100%}.banner-form[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:20px}.banner-form[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{width:50%}.banner-form[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     button{width:100%}.banner-form[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:10px}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{width:calc(25% - 8px)}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;height:200px;border-radius:4px;position:relative}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;border-radius:5px}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .image-actions[_ngcontent-%COMP%]{opacity:0;transition:opacity .4s;display:flex;align-items:center;justify-content:center;gap:10px;inset:0;position:absolute;width:100%;height:100%;background:#0003;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);border-radius:5px}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .image-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;width:36px;height:36px;padding:4px 10px;justify-content:center;align-items:center;gap:12px;border:none;outline:none;border-radius:8px;cursor:pointer;color:#75758b}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .image-actions[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{color:#8b0000}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover   .image-actions[_ngcontent-%COMP%]{opacity:1}.banner-form[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .upload[_ngcontent-%COMP%]{border-radius:4px;border:1px dashed rgba(117,117,139,.6);flex-direction:column;font-size:18px;color:#75758b;cursor:pointer}"]})};export{le as BannerFormComponent};
